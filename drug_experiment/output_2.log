2024-04-23 19:22:47.818987: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-04-23 19:22:50.091030: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Map:   0%|          | 0/161297 [00:00<?, ? examples/s]Map:   1%|          | 1000/161297 [00:01<03:04, 868.95 examples/s]Map:   1%|          | 2000/161297 [00:01<01:29, 1777.66 examples/s]Map:   2%|▏         | 3000/161297 [00:01<00:59, 2670.40 examples/s]Map:   2%|▏         | 4000/161297 [00:01<00:44, 3526.58 examples/s]Map:   3%|▎         | 5000/161297 [00:01<00:36, 4276.07 examples/s]Map:   4%|▎         | 6000/161297 [00:01<00:31, 4885.31 examples/s]Map:   4%|▍         | 7000/161297 [00:02<00:28, 5344.00 examples/s]Map:   5%|▍         | 8000/161297 [00:02<00:27, 5593.59 examples/s]Map:   6%|▌         | 9000/161297 [00:02<00:26, 5811.17 examples/s]Map:   6%|▌         | 10000/161297 [00:02<00:24, 6061.24 examples/s]Map:   7%|▋         | 11000/161297 [00:02<00:33, 4482.17 examples/s]Map:   7%|▋         | 12000/161297 [00:03<00:29, 4987.97 examples/s]Map:   8%|▊         | 13000/161297 [00:03<00:27, 5443.78 examples/s]Map:   9%|▊         | 14000/161297 [00:03<00:25, 5809.34 examples/s]Map:   9%|▉         | 15000/161297 [00:03<00:24, 6065.26 examples/s]Map:  10%|▉         | 16000/161297 [00:03<00:23, 6237.74 examples/s]Map:  11%|█         | 17000/161297 [00:03<00:22, 6324.10 examples/s]Map:  11%|█         | 18000/161297 [00:03<00:22, 6451.95 examples/s]Map:  12%|█▏        | 19000/161297 [00:04<00:21, 6524.81 examples/s]Map:  12%|█▏        | 20000/161297 [00:04<00:21, 6569.27 examples/s]Map:  13%|█▎        | 21000/161297 [00:04<00:21, 6581.71 examples/s]Map:  14%|█▎        | 22000/161297 [00:04<00:21, 6624.96 examples/s]Map:  14%|█▍        | 23000/161297 [00:04<00:21, 6568.61 examples/s]Map:  15%|█▍        | 24000/161297 [00:04<00:20, 6650.41 examples/s]Map:  15%|█▌        | 25000/161297 [00:04<00:20, 6671.97 examples/s]Map:  16%|█▌        | 26000/161297 [00:05<00:20, 6722.11 examples/s]Map:  17%|█▋        | 27000/161297 [00:05<00:19, 6747.41 examples/s]Map:  17%|█▋        | 28000/161297 [00:05<00:19, 6753.32 examples/s]Map:  18%|█▊        | 29000/161297 [00:05<00:19, 6756.20 examples/s]Map:  19%|█▊        | 30000/161297 [00:05<00:19, 6695.69 examples/s]Map:  19%|█▉        | 31000/161297 [00:05<00:19, 6724.72 examples/s]Map:  20%|█▉        | 32000/161297 [00:06<00:19, 6528.98 examples/s]Map:  20%|██        | 33000/161297 [00:06<00:19, 6526.26 examples/s]Map:  21%|██        | 34000/161297 [00:06<00:19, 6549.41 examples/s]Map:  22%|██▏       | 35000/161297 [00:06<00:19, 6598.72 examples/s]Map:  22%|██▏       | 36000/161297 [00:06<00:19, 6587.78 examples/s]Map:  23%|██▎       | 37000/161297 [00:06<00:18, 6615.07 examples/s]Map:  24%|██▎       | 38000/161297 [00:06<00:18, 6643.32 examples/s]Map:  24%|██▍       | 39000/161297 [00:07<00:18, 6680.44 examples/s]Map:  25%|██▍       | 40000/161297 [00:07<00:18, 6699.77 examples/s]Map:  25%|██▌       | 41000/161297 [00:07<00:18, 6662.29 examples/s]Map:  26%|██▌       | 42000/161297 [00:07<00:17, 6653.61 examples/s]Map:  27%|██▋       | 43000/161297 [00:07<00:17, 6653.53 examples/s]Map:  27%|██▋       | 44000/161297 [00:07<00:17, 6692.66 examples/s]Map:  28%|██▊       | 45000/161297 [00:07<00:17, 6654.37 examples/s]Map:  29%|██▊       | 46000/161297 [00:08<00:17, 6647.35 examples/s]Map:  29%|██▉       | 47000/161297 [00:08<00:17, 6711.59 examples/s]Map:  30%|██▉       | 48000/161297 [00:08<00:16, 6709.96 examples/s]Map:  30%|███       | 49000/161297 [00:08<00:16, 6680.59 examples/s]Map:  31%|███       | 50000/161297 [00:08<00:16, 6698.43 examples/s]Map:  32%|███▏      | 51000/161297 [00:08<00:16, 6694.26 examples/s]Map:  32%|███▏      | 52000/161297 [00:08<00:16, 6700.25 examples/s]Map:  33%|███▎      | 53000/161297 [00:09<00:16, 6667.35 examples/s]Map:  33%|███▎      | 54000/161297 [00:09<00:15, 6725.74 examples/s]Map:  34%|███▍      | 55000/161297 [00:09<00:15, 6751.41 examples/s]Map:  35%|███▍      | 56000/161297 [00:09<00:23, 4509.78 examples/s]Map:  35%|███▌      | 57000/161297 [00:09<00:21, 4960.02 examples/s]Map:  36%|███▌      | 58000/161297 [00:10<00:19, 5392.64 examples/s]Map:  37%|███▋      | 59000/161297 [00:10<00:17, 5691.59 examples/s]Map:  37%|███▋      | 60000/161297 [00:10<00:16, 5961.84 examples/s]Map:  38%|███▊      | 61000/161297 [00:10<00:16, 6143.82 examples/s]Map:  38%|███▊      | 62000/161297 [00:10<00:15, 6269.07 examples/s]Map:  39%|███▉      | 63000/161297 [00:10<00:15, 6405.67 examples/s]Map:  40%|███▉      | 64000/161297 [00:11<00:15, 6463.21 examples/s]Map:  40%|████      | 65000/161297 [00:11<00:14, 6551.55 examples/s]Map:  41%|████      | 66000/161297 [00:11<00:14, 6535.87 examples/s]Map:  42%|████▏     | 67000/161297 [00:11<00:14, 6642.06 examples/s]Map:  42%|████▏     | 68000/161297 [00:11<00:14, 6661.51 examples/s]Map:  43%|████▎     | 69000/161297 [00:11<00:13, 6687.43 examples/s]Map:  43%|████▎     | 70000/161297 [00:11<00:13, 6697.36 examples/s]Map:  44%|████▍     | 71000/161297 [00:12<00:13, 6715.36 examples/s]Map:  45%|████▍     | 72000/161297 [00:12<00:13, 6728.81 examples/s]Map:  45%|████▌     | 73000/161297 [00:12<00:13, 6774.23 examples/s]Map:  46%|████▌     | 74000/161297 [00:12<00:12, 6736.40 examples/s]Map:  46%|████▋     | 75000/161297 [00:12<00:12, 6759.15 examples/s]Map:  47%|████▋     | 76000/161297 [00:12<00:12, 6765.76 examples/s]Map:  48%|████▊     | 77000/161297 [00:12<00:12, 6745.92 examples/s]Map:  48%|████▊     | 78000/161297 [00:13<00:12, 6657.71 examples/s]Map:  49%|████▉     | 79000/161297 [00:13<00:12, 6655.63 examples/s]Map:  50%|████▉     | 80000/161297 [00:13<00:12, 6657.34 examples/s]Map:  50%|█████     | 81000/161297 [00:13<00:12, 6645.71 examples/s]Map:  51%|█████     | 82000/161297 [00:13<00:11, 6616.09 examples/s]Map:  51%|█████▏    | 83000/161297 [00:13<00:11, 6699.50 examples/s]Map:  52%|█████▏    | 84000/161297 [00:14<00:11, 6714.61 examples/s]Map:  53%|█████▎    | 85000/161297 [00:14<00:11, 6751.24 examples/s]Map:  53%|█████▎    | 86000/161297 [00:14<00:11, 6741.33 examples/s]Map:  54%|█████▍    | 87000/161297 [00:14<00:11, 6709.47 examples/s]Map:  55%|█████▍    | 88000/161297 [00:14<00:10, 6736.50 examples/s]Map:  55%|█████▌    | 89000/161297 [00:14<00:10, 6680.64 examples/s]Map:  56%|█████▌    | 90000/161297 [00:14<00:10, 6684.13 examples/s]Map:  56%|█████▋    | 91000/161297 [00:15<00:10, 6665.06 examples/s]Map:  57%|█████▋    | 92000/161297 [00:15<00:10, 6684.62 examples/s]Map:  58%|█████▊    | 93000/161297 [00:15<00:10, 6748.30 examples/s]Map:  58%|█████▊    | 94000/161297 [00:15<00:10, 6696.42 examples/s]Map:  59%|█████▉    | 95000/161297 [00:15<00:09, 6733.89 examples/s]Map:  60%|█████▉    | 96000/161297 [00:15<00:09, 6705.40 examples/s]Map:  60%|██████    | 97000/161297 [00:15<00:09, 6715.65 examples/s]Map:  61%|██████    | 98000/161297 [00:16<00:09, 6762.12 examples/s]Map:  61%|██████▏   | 99000/161297 [00:16<00:09, 6732.04 examples/s]Map:  62%|██████▏   | 100000/161297 [00:16<00:09, 6734.33 examples/s]Map:  63%|██████▎   | 101000/161297 [00:16<00:12, 4735.46 examples/s]Map:  63%|██████▎   | 102000/161297 [00:16<00:11, 5154.98 examples/s]Map:  64%|██████▍   | 103000/161297 [00:17<00:10, 5527.67 examples/s]Map:  64%|██████▍   | 104000/161297 [00:17<00:09, 5825.34 examples/s]Map:  65%|██████▌   | 105000/161297 [00:17<00:09, 6059.85 examples/s]Map:  66%|██████▌   | 106000/161297 [00:17<00:08, 6264.19 examples/s]Map:  66%|██████▋   | 107000/161297 [00:17<00:08, 6394.90 examples/s]Map:  67%|██████▋   | 108000/161297 [00:17<00:08, 6378.37 examples/s]Map:  68%|██████▊   | 109000/161297 [00:17<00:08, 6366.84 examples/s]Map:  68%|██████▊   | 110000/161297 [00:18<00:07, 6457.15 examples/s]Map:  69%|██████▉   | 111000/161297 [00:18<00:07, 6505.18 examples/s]Map:  69%|██████▉   | 112000/161297 [00:18<00:07, 6541.62 examples/s]Map:  70%|███████   | 113000/161297 [00:18<00:07, 6607.31 examples/s]Map:  71%|███████   | 114000/161297 [00:18<00:07, 6660.87 examples/s]Map:  71%|███████▏  | 115000/161297 [00:18<00:06, 6664.33 examples/s]Map:  72%|███████▏  | 116000/161297 [00:19<00:06, 6658.88 examples/s]Map:  73%|███████▎  | 117000/161297 [00:19<00:06, 6707.19 examples/s]Map:  73%|███████▎  | 118000/161297 [00:19<00:06, 6699.24 examples/s]Map:  74%|███████▍  | 119000/161297 [00:19<00:06, 6606.31 examples/s]Map:  74%|███████▍  | 120000/161297 [00:19<00:06, 6654.11 examples/s]Map:  75%|███████▌  | 121000/161297 [00:19<00:06, 6660.65 examples/s]Map:  76%|███████▌  | 122000/161297 [00:19<00:05, 6704.25 examples/s]Map:  76%|███████▋  | 123000/161297 [00:20<00:05, 6672.94 examples/s]Map:  77%|███████▋  | 124000/161297 [00:20<00:05, 6706.80 examples/s]Map:  77%|███████▋  | 125000/161297 [00:20<00:05, 6662.02 examples/s]Map:  78%|███████▊  | 126000/161297 [00:20<00:05, 6657.03 examples/s]Map:  79%|███████▊  | 127000/161297 [00:20<00:05, 6657.97 examples/s]Map:  79%|███████▉  | 128000/161297 [00:20<00:05, 5587.77 examples/s]Map:  80%|███████▉  | 129000/161297 [00:21<00:05, 5878.92 examples/s]Map:  81%|████████  | 130000/161297 [00:21<00:05, 6107.01 examples/s]Map:  81%|████████  | 131000/161297 [00:21<00:04, 6281.50 examples/s]Map:  82%|████████▏ | 132000/161297 [00:21<00:04, 6355.72 examples/s]Map:  82%|████████▏ | 133000/161297 [00:21<00:04, 6389.98 examples/s]Map:  83%|████████▎ | 134000/161297 [00:21<00:04, 6408.34 examples/s]Map:  84%|████████▎ | 135000/161297 [00:21<00:04, 6425.20 examples/s]Map:  84%|████████▍ | 136000/161297 [00:22<00:03, 6503.22 examples/s]Map:  85%|████████▍ | 137000/161297 [00:22<00:03, 6564.59 examples/s]Map:  86%|████████▌ | 138000/161297 [00:22<00:03, 6586.84 examples/s]Map:  86%|████████▌ | 139000/161297 [00:22<00:03, 6617.52 examples/s]Map:  87%|████████▋ | 140000/161297 [00:22<00:03, 6628.04 examples/s]Map:  87%|████████▋ | 141000/161297 [00:22<00:03, 6698.56 examples/s]Map:  88%|████████▊ | 142000/161297 [00:23<00:02, 6720.37 examples/s]Map:  89%|████████▊ | 143000/161297 [00:23<00:02, 6694.80 examples/s]Map:  89%|████████▉ | 144000/161297 [00:23<00:02, 6701.02 examples/s]Map:  90%|████████▉ | 145000/161297 [00:23<00:02, 6727.97 examples/s]Map:  91%|█████████ | 146000/161297 [00:23<00:03, 4565.13 examples/s]Map:  91%|█████████ | 147000/161297 [00:24<00:02, 5022.78 examples/s]Map:  92%|█████████▏| 148000/161297 [00:24<00:03, 3888.86 examples/s]Map:  92%|█████████▏| 149000/161297 [00:24<00:02, 4427.82 examples/s]Map:  93%|█████████▎| 150000/161297 [00:24<00:02, 4855.64 examples/s]Map:  94%|█████████▎| 151000/161297 [00:24<00:01, 5261.03 examples/s]Map:  94%|█████████▍| 152000/161297 [00:25<00:01, 5574.05 examples/s]Map:  95%|█████████▍| 153000/161297 [00:25<00:01, 5849.22 examples/s]Map:  95%|█████████▌| 154000/161297 [00:25<00:01, 6067.53 examples/s]Map:  96%|█████████▌| 155000/161297 [00:25<00:01, 6265.80 examples/s]Map:  97%|█████████▋| 156000/161297 [00:25<00:00, 6428.28 examples/s]Map:  97%|█████████▋| 157000/161297 [00:25<00:00, 6498.44 examples/s]Map:  98%|█████████▊| 158000/161297 [00:25<00:00, 6521.03 examples/s]Map:  99%|█████████▊| 159000/161297 [00:26<00:00, 6630.77 examples/s]Map:  99%|█████████▉| 160000/161297 [00:26<00:00, 6614.73 examples/s]Map: 100%|█████████▉| 161000/161297 [00:26<00:00, 6661.30 examples/s]Map: 100%|██████████| 161297/161297 [00:26<00:00, 6106.86 examples/s]
Map:   0%|          | 0/53766 [00:00<?, ? examples/s]Map:   2%|▏         | 1000/53766 [00:00<00:07, 6661.07 examples/s]Map:   4%|▎         | 2000/53766 [00:00<00:07, 6574.51 examples/s]Map:   6%|▌         | 3000/53766 [00:00<00:07, 6673.52 examples/s]Map:   7%|▋         | 4000/53766 [00:00<00:07, 6688.32 examples/s]Map:   9%|▉         | 5000/53766 [00:00<00:07, 6686.46 examples/s]Map:  11%|█         | 6000/53766 [00:00<00:07, 6622.26 examples/s]Map:  13%|█▎        | 7000/53766 [00:01<00:07, 6653.00 examples/s]Map:  15%|█▍        | 8000/53766 [00:01<00:06, 6688.08 examples/s]Map:  17%|█▋        | 9000/53766 [00:01<00:06, 6590.56 examples/s]Map:  19%|█▊        | 10000/53766 [00:01<00:06, 6642.99 examples/s]Map:  20%|██        | 11000/53766 [00:01<00:06, 6683.42 examples/s]Map:  22%|██▏       | 12000/53766 [00:01<00:06, 6735.81 examples/s]Map:  24%|██▍       | 13000/53766 [00:01<00:06, 6680.39 examples/s]Map:  26%|██▌       | 14000/53766 [00:02<00:05, 6683.18 examples/s]Map:  28%|██▊       | 15000/53766 [00:02<00:05, 6731.26 examples/s]Map:  30%|██▉       | 16000/53766 [00:02<00:05, 6704.48 examples/s]Map:  32%|███▏      | 17000/53766 [00:02<00:05, 6706.36 examples/s]Map:  33%|███▎      | 18000/53766 [00:02<00:05, 6689.93 examples/s]Map:  35%|███▌      | 19000/53766 [00:02<00:05, 6694.07 examples/s]Map:  37%|███▋      | 20000/53766 [00:02<00:05, 6728.36 examples/s]Map:  39%|███▉      | 21000/53766 [00:03<00:04, 6773.05 examples/s]Map:  41%|████      | 22000/53766 [00:03<00:04, 6792.09 examples/s]Map:  43%|████▎     | 23000/53766 [00:03<00:04, 6777.55 examples/s]Map:  45%|████▍     | 24000/53766 [00:03<00:04, 6743.97 examples/s]Map:  46%|████▋     | 25000/53766 [00:03<00:04, 6645.26 examples/s]Map:  48%|████▊     | 26000/53766 [00:03<00:04, 6669.63 examples/s]Map:  50%|█████     | 27000/53766 [00:04<00:03, 6695.26 examples/s]Map:  52%|█████▏    | 28000/53766 [00:04<00:03, 6703.83 examples/s]Map:  54%|█████▍    | 29000/53766 [00:04<00:03, 6712.29 examples/s]Map:  56%|█████▌    | 30000/53766 [00:04<00:03, 6738.26 examples/s]Map:  58%|█████▊    | 31000/53766 [00:04<00:03, 6783.48 examples/s]Map:  60%|█████▉    | 32000/53766 [00:04<00:03, 6528.60 examples/s]Map:  61%|██████▏   | 33000/53766 [00:04<00:03, 6542.41 examples/s]Map:  63%|██████▎   | 34000/53766 [00:05<00:02, 6644.67 examples/s]Map:  65%|██████▌   | 35000/53766 [00:05<00:02, 6645.61 examples/s]Map:  67%|██████▋   | 36000/53766 [00:05<00:02, 6653.81 examples/s]Map:  69%|██████▉   | 37000/53766 [00:05<00:02, 6654.42 examples/s]Map:  71%|███████   | 38000/53766 [00:05<00:02, 6662.63 examples/s]Map:  73%|███████▎  | 39000/53766 [00:05<00:02, 6694.16 examples/s]Map:  74%|███████▍  | 40000/53766 [00:05<00:02, 6749.10 examples/s]Map:  76%|███████▋  | 41000/53766 [00:06<00:01, 6721.54 examples/s]Map:  78%|███████▊  | 42000/53766 [00:06<00:01, 6728.86 examples/s]Map:  80%|███████▉  | 43000/53766 [00:06<00:02, 4728.80 examples/s]Map:  82%|████████▏ | 44000/53766 [00:06<00:01, 5137.57 examples/s]Map:  84%|████████▎ | 45000/53766 [00:06<00:01, 5514.66 examples/s]Map:  86%|████████▌ | 46000/53766 [00:07<00:01, 5806.62 examples/s]Map:  87%|████████▋ | 47000/53766 [00:07<00:01, 6038.40 examples/s]Map:  89%|████████▉ | 48000/53766 [00:07<00:00, 6214.79 examples/s]Map:  91%|█████████ | 49000/53766 [00:07<00:00, 6329.48 examples/s]Map:  93%|█████████▎| 50000/53766 [00:07<00:00, 6403.68 examples/s]Map:  95%|█████████▍| 51000/53766 [00:07<00:00, 6490.42 examples/s]Map:  97%|█████████▋| 52000/53766 [00:07<00:00, 6570.42 examples/s]Map:  99%|█████████▊| 53000/53766 [00:08<00:00, 6611.94 examples/s]Map: 100%|██████████| 53766/53766 [00:08<00:00, 6646.20 examples/s]Map: 100%|██████████| 53766/53766 [00:08<00:00, 6510.86 examples/s]
Some weights of GPT2ForSequenceClassification were not initialized from the model checkpoint at openai-community/gpt2 and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Allocated GPU memory: 0.0 MB
Peak GPU memory usage: 0.0 MB
32259
10753
43013
************TRAINING STARTED*************
wandb: ERROR api_key not configured (no-tty). call wandb.login(key=[your_api_key])
Traceback (most recent call last):
  File "/accounts/grad/phudish_p/mllm/drug_experiment/drug_dataset_test.py", line 186, in <module>
    main()
  File "/accounts/grad/phudish_p/mllm/drug_experiment/drug_dataset_test.py", line 130, in main
    result = trainer.train()
             ^^^^^^^^^^^^^^^
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/trainer.py", line 1783, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/trainer.py", line 2039, in _inner_training_loop
    self.control = self.callback_handler.on_train_begin(args, self.state, self.control)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/trainer_callback.py", line 370, in on_train_begin
    return self.call_event("on_train_begin", args, state, control)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/trainer_callback.py", line 414, in call_event
    result = getattr(callback, event)(
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/integrations/integration_utils.py", line 768, in on_train_begin
    self.setup(args, state, model, **kwargs)
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/integrations/integration_utils.py", line 741, in setup
    self._wandb.init(
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/wandb/sdk/wandb_init.py", line 1200, in init
    raise e
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/wandb/sdk/wandb_init.py", line 1177, in init
    wi.setup(kwargs)
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/wandb/sdk/wandb_init.py", line 301, in setup
    wandb_login._login(
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/wandb/sdk/wandb_login.py", line 334, in _login
    wlogin.prompt_api_key()
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/wandb/sdk/wandb_login.py", line 263, in prompt_api_key
    raise UsageError("api_key not configured (no-tty). call " + directive)
wandb.errors.UsageError: api_key not configured (no-tty). call wandb.login(key=[your_api_key])
