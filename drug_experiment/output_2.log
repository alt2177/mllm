2024-04-23 19:36:00.608787: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-04-23 19:36:02.660848: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Map:   0%|          | 0/161297 [00:00<?, ? examples/s]Map:   1%|          | 1000/161297 [00:00<00:27, 5887.73 examples/s]Map:   1%|          | 2000/161297 [00:00<00:24, 6427.61 examples/s]Map:   2%|▏         | 3000/161297 [00:00<00:24, 6522.46 examples/s]Map:   2%|▏         | 4000/161297 [00:00<00:23, 6665.86 examples/s]Map:   3%|▎         | 5000/161297 [00:00<00:23, 6720.86 examples/s]Map:   4%|▎         | 6000/161297 [00:00<00:23, 6719.12 examples/s]Map:   4%|▍         | 7000/161297 [00:01<00:23, 6693.67 examples/s]Map:   5%|▍         | 8000/161297 [00:01<00:23, 6634.93 examples/s]Map:   6%|▌         | 9000/161297 [00:01<00:23, 6436.22 examples/s]Map:   6%|▌         | 10000/161297 [00:01<00:23, 6512.11 examples/s]Map:   7%|▋         | 11000/161297 [00:01<00:33, 4530.15 examples/s]Map:   7%|▋         | 12000/161297 [00:02<00:29, 5039.42 examples/s]Map:   8%|▊         | 13000/161297 [00:02<00:27, 5478.02 examples/s]Map:   9%|▊         | 14000/161297 [00:02<00:25, 5812.80 examples/s]Map:   9%|▉         | 15000/161297 [00:02<00:24, 6051.43 examples/s]Map:  10%|▉         | 16000/161297 [00:02<00:23, 6220.43 examples/s]Map:  11%|█         | 17000/161297 [00:02<00:22, 6295.07 examples/s]Map:  11%|█         | 18000/161297 [00:02<00:22, 6451.83 examples/s]Map:  12%|█▏        | 19000/161297 [00:03<00:21, 6493.37 examples/s]Map:  12%|█▏        | 20000/161297 [00:03<00:21, 6554.04 examples/s]Map:  13%|█▎        | 21000/161297 [00:03<00:21, 6577.43 examples/s]Map:  14%|█▎        | 22000/161297 [00:03<00:21, 6614.72 examples/s]Map:  14%|█▍        | 23000/161297 [00:03<00:20, 6646.57 examples/s]Map:  15%|█▍        | 24000/161297 [00:03<00:20, 6711.99 examples/s]Map:  15%|█▌        | 25000/161297 [00:03<00:20, 6709.87 examples/s]Map:  16%|█▌        | 26000/161297 [00:04<00:20, 6720.95 examples/s]Map:  17%|█▋        | 27000/161297 [00:04<00:20, 6703.68 examples/s]Map:  17%|█▋        | 28000/161297 [00:04<00:19, 6730.35 examples/s]Map:  18%|█▊        | 29000/161297 [00:04<00:19, 6767.99 examples/s]Map:  19%|█▊        | 30000/161297 [00:04<00:19, 6699.86 examples/s]Map:  19%|█▉        | 31000/161297 [00:04<00:19, 6710.41 examples/s]Map:  20%|█▉        | 32000/161297 [00:05<00:19, 6518.07 examples/s]Map:  20%|██        | 33000/161297 [00:05<00:19, 6528.91 examples/s]Map:  21%|██        | 34000/161297 [00:05<00:19, 6583.01 examples/s]Map:  22%|██▏       | 35000/161297 [00:05<00:19, 6617.55 examples/s]Map:  22%|██▏       | 36000/161297 [00:05<00:18, 6615.43 examples/s]Map:  23%|██▎       | 37000/161297 [00:05<00:18, 6621.83 examples/s]Map:  24%|██▎       | 38000/161297 [00:05<00:18, 6627.46 examples/s]Map:  24%|██▍       | 39000/161297 [00:06<00:18, 6665.03 examples/s]Map:  25%|██▍       | 40000/161297 [00:06<00:18, 6701.69 examples/s]Map:  25%|██▌       | 41000/161297 [00:06<00:18, 6676.11 examples/s]Map:  26%|██▌       | 42000/161297 [00:06<00:17, 6648.54 examples/s]Map:  27%|██▋       | 43000/161297 [00:06<00:17, 6645.55 examples/s]Map:  27%|██▋       | 44000/161297 [00:06<00:17, 6676.74 examples/s]Map:  28%|██▊       | 45000/161297 [00:06<00:17, 6681.01 examples/s]Map:  29%|██▊       | 46000/161297 [00:07<00:17, 6669.09 examples/s]Map:  29%|██▉       | 47000/161297 [00:07<00:17, 6690.60 examples/s]Map:  30%|██▉       | 48000/161297 [00:07<00:16, 6690.77 examples/s]Map:  30%|███       | 49000/161297 [00:07<00:17, 6559.06 examples/s]Map:  31%|███       | 50000/161297 [00:07<00:16, 6557.70 examples/s]Map:  32%|███▏      | 51000/161297 [00:07<00:16, 6583.01 examples/s]Map:  32%|███▏      | 52000/161297 [00:08<00:16, 6598.21 examples/s]Map:  33%|███▎      | 53000/161297 [00:08<00:16, 6598.34 examples/s]Map:  33%|███▎      | 54000/161297 [00:08<00:16, 6640.96 examples/s]Map:  34%|███▍      | 55000/161297 [00:08<00:15, 6687.56 examples/s]Map:  35%|███▍      | 56000/161297 [00:08<00:23, 4506.48 examples/s]Map:  35%|███▌      | 57000/161297 [00:09<00:20, 4978.85 examples/s]Map:  36%|███▌      | 58000/161297 [00:09<00:19, 5401.81 examples/s]Map:  37%|███▋      | 59000/161297 [00:09<00:18, 5652.99 examples/s]Map:  37%|███▋      | 60000/161297 [00:09<00:17, 5932.96 examples/s]Map:  38%|███▊      | 61000/161297 [00:09<00:16, 6120.00 examples/s]Map:  38%|███▊      | 62000/161297 [00:09<00:15, 6256.72 examples/s]Map:  39%|███▉      | 63000/161297 [00:09<00:15, 6365.86 examples/s]Map:  40%|███▉      | 64000/161297 [00:10<00:15, 6456.02 examples/s]Map:  40%|████      | 65000/161297 [00:10<00:14, 6558.97 examples/s]Map:  41%|████      | 66000/161297 [00:10<00:14, 6561.86 examples/s]Map:  42%|████▏     | 67000/161297 [00:10<00:14, 6658.81 examples/s]Map:  42%|████▏     | 68000/161297 [00:10<00:14, 6660.53 examples/s]Map:  43%|████▎     | 69000/161297 [00:10<00:13, 6684.57 examples/s]Map:  43%|████▎     | 70000/161297 [00:10<00:13, 6684.64 examples/s]Map:  44%|████▍     | 71000/161297 [00:11<00:13, 6722.68 examples/s]Map:  45%|████▍     | 72000/161297 [00:11<00:13, 6701.69 examples/s]Map:  45%|████▌     | 73000/161297 [00:11<00:13, 6750.30 examples/s]Map:  46%|████▌     | 74000/161297 [00:11<00:12, 6718.10 examples/s]Map:  46%|████▋     | 75000/161297 [00:11<00:12, 6718.28 examples/s]Map:  47%|████▋     | 76000/161297 [00:11<00:12, 6724.03 examples/s]Map:  48%|████▊     | 77000/161297 [00:12<00:12, 6690.94 examples/s]Map:  48%|████▊     | 78000/161297 [00:12<00:12, 6706.85 examples/s]Map:  49%|████▉     | 79000/161297 [00:12<00:12, 6656.16 examples/s]Map:  50%|████▉     | 80000/161297 [00:12<00:12, 6663.99 examples/s]Map:  50%|█████     | 81000/161297 [00:12<00:12, 6636.87 examples/s]Map:  51%|█████     | 82000/161297 [00:12<00:11, 6690.11 examples/s]Map:  51%|█████▏    | 83000/161297 [00:12<00:11, 6755.51 examples/s]Map:  52%|█████▏    | 84000/161297 [00:13<00:11, 6762.70 examples/s]Map:  53%|█████▎    | 85000/161297 [00:13<00:11, 6776.10 examples/s]Map:  53%|█████▎    | 86000/161297 [00:13<00:11, 6759.00 examples/s]Map:  54%|█████▍    | 87000/161297 [00:13<00:11, 6707.98 examples/s]Map:  55%|█████▍    | 88000/161297 [00:13<00:10, 6708.12 examples/s]Map:  55%|█████▌    | 89000/161297 [00:13<00:10, 6750.93 examples/s]Map:  56%|█████▌    | 90000/161297 [00:13<00:10, 6736.16 examples/s]Map:  56%|█████▋    | 91000/161297 [00:14<00:10, 6714.88 examples/s]Map:  57%|█████▋    | 92000/161297 [00:14<00:10, 6698.88 examples/s]Map:  58%|█████▊    | 93000/161297 [00:14<00:10, 6744.26 examples/s]Map:  58%|█████▊    | 94000/161297 [00:14<00:10, 6680.55 examples/s]Map:  59%|█████▉    | 95000/161297 [00:14<00:09, 6696.19 examples/s]Map:  60%|█████▉    | 96000/161297 [00:14<00:09, 6644.06 examples/s]Map:  60%|██████    | 97000/161297 [00:15<00:09, 6667.24 examples/s]Map:  61%|██████    | 98000/161297 [00:15<00:09, 6699.63 examples/s]Map:  61%|██████▏   | 99000/161297 [00:15<00:09, 6719.44 examples/s]Map:  62%|██████▏   | 100000/161297 [00:15<00:09, 6722.80 examples/s]Map:  63%|██████▎   | 101000/161297 [00:15<00:13, 4582.57 examples/s]Map:  63%|██████▎   | 102000/161297 [00:15<00:11, 5040.12 examples/s]Map:  64%|██████▍   | 103000/161297 [00:16<00:10, 5442.67 examples/s]Map:  64%|██████▍   | 104000/161297 [00:16<00:09, 5778.56 examples/s]Map:  65%|██████▌   | 105000/161297 [00:16<00:09, 6015.94 examples/s]Map:  66%|██████▌   | 106000/161297 [00:16<00:08, 6225.52 examples/s]Map:  66%|██████▋   | 107000/161297 [00:16<00:08, 6355.02 examples/s]Map:  67%|██████▋   | 108000/161297 [00:16<00:08, 6516.07 examples/s]Map:  68%|██████▊   | 109000/161297 [00:17<00:08, 6534.61 examples/s]Map:  68%|██████▊   | 110000/161297 [00:17<00:07, 6502.95 examples/s]Map:  69%|██████▉   | 111000/161297 [00:17<00:07, 6545.22 examples/s]Map:  69%|██████▉   | 112000/161297 [00:17<00:07, 6589.43 examples/s]Map:  70%|███████   | 113000/161297 [00:17<00:07, 6645.83 examples/s]Map:  71%|███████   | 114000/161297 [00:17<00:07, 6637.05 examples/s]Map:  71%|███████▏  | 115000/161297 [00:17<00:06, 6653.21 examples/s]Map:  72%|███████▏  | 116000/161297 [00:18<00:06, 6662.45 examples/s]Map:  73%|███████▎  | 117000/161297 [00:18<00:06, 6685.95 examples/s]Map:  73%|███████▎  | 118000/161297 [00:18<00:06, 6670.60 examples/s]Map:  74%|███████▍  | 119000/161297 [00:18<00:06, 6705.67 examples/s]Map:  74%|███████▍  | 120000/161297 [00:18<00:06, 6700.45 examples/s]Map:  75%|███████▌  | 121000/161297 [00:18<00:06, 6710.23 examples/s]Map:  76%|███████▌  | 122000/161297 [00:18<00:05, 6734.36 examples/s]Map:  76%|███████▋  | 123000/161297 [00:19<00:05, 6713.08 examples/s]Map:  77%|███████▋  | 124000/161297 [00:19<00:05, 6706.91 examples/s]Map:  77%|███████▋  | 125000/161297 [00:19<00:05, 6680.68 examples/s]Map:  78%|███████▊  | 126000/161297 [00:19<00:05, 6659.35 examples/s]Map:  79%|███████▊  | 127000/161297 [00:19<00:05, 6640.51 examples/s]Map:  79%|███████▉  | 128000/161297 [00:19<00:05, 5685.07 examples/s]Map:  80%|███████▉  | 129000/161297 [00:20<00:05, 5972.63 examples/s]Map:  81%|████████  | 130000/161297 [00:20<00:05, 6163.16 examples/s]Map:  81%|████████  | 131000/161297 [00:20<00:04, 6328.74 examples/s]Map:  82%|████████▏ | 132000/161297 [00:20<00:04, 6393.97 examples/s]Map:  82%|████████▏ | 133000/161297 [00:20<00:04, 6416.30 examples/s]Map:  83%|████████▎ | 134000/161297 [00:20<00:04, 6488.33 examples/s]Map:  84%|████████▎ | 135000/161297 [00:21<00:04, 6493.61 examples/s]Map:  84%|████████▍ | 136000/161297 [00:21<00:03, 6541.76 examples/s]Map:  85%|████████▍ | 137000/161297 [00:21<00:03, 6605.55 examples/s]Map:  86%|████████▌ | 138000/161297 [00:21<00:03, 6613.68 examples/s]Map:  86%|████████▌ | 139000/161297 [00:21<00:03, 6601.33 examples/s]Map:  87%|████████▋ | 140000/161297 [00:21<00:03, 6611.86 examples/s]Map:  87%|████████▋ | 141000/161297 [00:21<00:03, 6699.60 examples/s]Map:  88%|████████▊ | 142000/161297 [00:22<00:02, 6720.11 examples/s]Map:  89%|████████▊ | 143000/161297 [00:22<00:02, 6685.53 examples/s]Map:  89%|████████▉ | 144000/161297 [00:22<00:02, 6718.11 examples/s]Map:  90%|████████▉ | 145000/161297 [00:22<00:02, 6748.79 examples/s]Map:  91%|█████████ | 146000/161297 [00:22<00:03, 4715.11 examples/s]Map:  91%|█████████ | 147000/161297 [00:23<00:02, 5175.58 examples/s]Map:  92%|█████████▏| 148000/161297 [00:23<00:02, 5549.91 examples/s]Map:  92%|█████████▏| 149000/161297 [00:23<00:02, 5835.41 examples/s]Map:  93%|█████████▎| 150000/161297 [00:23<00:01, 6041.94 examples/s]Map:  94%|█████████▎| 151000/161297 [00:23<00:01, 6179.83 examples/s]Map:  94%|█████████▍| 152000/161297 [00:23<00:01, 6293.12 examples/s]Map:  95%|█████████▍| 153000/161297 [00:23<00:01, 6419.99 examples/s]Map:  95%|█████████▌| 154000/161297 [00:24<00:01, 6469.31 examples/s]Map:  96%|█████████▌| 155000/161297 [00:24<00:00, 6580.09 examples/s]Map:  97%|█████████▋| 156000/161297 [00:24<00:00, 6670.51 examples/s]Map:  97%|█████████▋| 157000/161297 [00:24<00:00, 6649.14 examples/s]Map:  98%|█████████▊| 158000/161297 [00:24<00:00, 6661.38 examples/s]Map:  99%|█████████▊| 159000/161297 [00:24<00:00, 6744.52 examples/s]Map:  99%|█████████▉| 160000/161297 [00:24<00:00, 6703.71 examples/s]Map: 100%|█████████▉| 161000/161297 [00:25<00:00, 6694.14 examples/s]Map: 100%|██████████| 161297/161297 [00:25<00:00, 6408.44 examples/s]
Map:   0%|          | 0/53766 [00:00<?, ? examples/s]Map:   2%|▏         | 1000/53766 [00:00<00:07, 6701.79 examples/s]Map:   4%|▎         | 2000/53766 [00:00<00:07, 6590.58 examples/s]Map:   6%|▌         | 3000/53766 [00:00<00:07, 6711.92 examples/s]Map:   7%|▋         | 4000/53766 [00:00<00:07, 6696.93 examples/s]Map:   9%|▉         | 5000/53766 [00:00<00:07, 6655.98 examples/s]Map:  11%|█         | 6000/53766 [00:00<00:07, 6673.20 examples/s]Map:  13%|█▎        | 7000/53766 [00:01<00:07, 6672.44 examples/s]Map:  15%|█▍        | 8000/53766 [00:01<00:06, 6702.47 examples/s]Map:  17%|█▋        | 9000/53766 [00:01<00:06, 6622.76 examples/s]Map:  19%|█▊        | 10000/53766 [00:01<00:06, 6665.62 examples/s]Map:  20%|██        | 11000/53766 [00:01<00:06, 6701.93 examples/s]Map:  22%|██▏       | 12000/53766 [00:01<00:06, 6737.78 examples/s]Map:  24%|██▍       | 13000/53766 [00:01<00:06, 6713.25 examples/s]Map:  26%|██▌       | 14000/53766 [00:02<00:05, 6673.41 examples/s]Map:  28%|██▊       | 15000/53766 [00:02<00:05, 6720.11 examples/s]Map:  30%|██▉       | 16000/53766 [00:02<00:05, 6702.39 examples/s]Map:  32%|███▏      | 17000/53766 [00:02<00:05, 6684.74 examples/s]Map:  33%|███▎      | 18000/53766 [00:02<00:05, 6723.07 examples/s]Map:  35%|███▌      | 19000/53766 [00:02<00:05, 6702.88 examples/s]Map:  37%|███▋      | 20000/53766 [00:02<00:05, 6716.86 examples/s]Map:  39%|███▉      | 21000/53766 [00:03<00:04, 6778.02 examples/s]Map:  41%|████      | 22000/53766 [00:03<00:04, 6776.69 examples/s]Map:  43%|████▎     | 23000/53766 [00:03<00:04, 6784.36 examples/s]Map:  45%|████▍     | 24000/53766 [00:03<00:04, 6760.78 examples/s]Map:  46%|████▋     | 25000/53766 [00:03<00:04, 6719.89 examples/s]Map:  48%|████▊     | 26000/53766 [00:03<00:04, 6714.18 examples/s]Map:  50%|█████     | 27000/53766 [00:04<00:03, 6726.30 examples/s]Map:  52%|█████▏    | 28000/53766 [00:04<00:03, 6729.73 examples/s]Map:  54%|█████▍    | 29000/53766 [00:04<00:03, 6721.92 examples/s]Map:  56%|█████▌    | 30000/53766 [00:04<00:03, 6757.83 examples/s]Map:  58%|█████▊    | 31000/53766 [00:04<00:03, 6806.23 examples/s]Map:  60%|█████▉    | 32000/53766 [00:04<00:03, 6503.41 examples/s]Map:  61%|██████▏   | 33000/53766 [00:04<00:03, 6453.12 examples/s]Map:  63%|██████▎   | 34000/53766 [00:05<00:03, 6545.03 examples/s]Map:  65%|██████▌   | 35000/53766 [00:05<00:02, 6599.75 examples/s]Map:  67%|██████▋   | 36000/53766 [00:05<00:02, 6615.28 examples/s]Map:  69%|██████▉   | 37000/53766 [00:05<00:02, 6629.85 examples/s]Map:  71%|███████   | 38000/53766 [00:05<00:02, 6631.73 examples/s]Map:  73%|███████▎  | 39000/53766 [00:05<00:02, 6682.03 examples/s]Map:  74%|███████▍  | 40000/53766 [00:05<00:02, 6728.62 examples/s]Map:  76%|███████▋  | 41000/53766 [00:06<00:01, 6718.08 examples/s]Map:  78%|███████▊  | 42000/53766 [00:06<00:01, 6712.52 examples/s]Map:  80%|███████▉  | 43000/53766 [00:06<00:02, 4749.08 examples/s]Map:  82%|████████▏ | 44000/53766 [00:06<00:01, 5223.77 examples/s]Map:  84%|████████▎ | 45000/53766 [00:06<00:01, 5595.03 examples/s]Map:  86%|████████▌ | 46000/53766 [00:07<00:01, 5871.65 examples/s]Map:  87%|████████▋ | 47000/53766 [00:07<00:01, 6084.98 examples/s]Map:  89%|████████▉ | 48000/53766 [00:07<00:00, 6243.56 examples/s]Map:  91%|█████████ | 49000/53766 [00:07<00:00, 6382.51 examples/s]Map:  93%|█████████▎| 50000/53766 [00:07<00:00, 6444.21 examples/s]Map:  95%|█████████▍| 51000/53766 [00:07<00:00, 6428.46 examples/s]Map:  97%|█████████▋| 52000/53766 [00:07<00:00, 6518.46 examples/s]Map:  99%|█████████▊| 53000/53766 [00:08<00:00, 6584.28 examples/s]Map: 100%|██████████| 53766/53766 [00:08<00:00, 6644.26 examples/s]Map: 100%|██████████| 53766/53766 [00:08<00:00, 6517.95 examples/s]
Some weights of GPT2ForSequenceClassification were not initialized from the model checkpoint at openai-community/gpt2 and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Allocated GPU memory: 0.0 MB
Peak GPU memory usage: 0.0 MB
32259
10753
43013
error creating repo for model. it probably already exists
************TRAINING STARTED*************
wandb: ERROR api_key not configured (no-tty). call wandb.login(key=[your_api_key])
Traceback (most recent call last):
  File "/accounts/grad/phudish_p/mllm/drug_experiment/drug_dataset_test.py", line 186, in <module>
    main()
  File "/accounts/grad/phudish_p/mllm/drug_experiment/drug_dataset_test.py", line 130, in main
    result = trainer.train()
             ^^^^^^^^^^^^^^^
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/trainer.py", line 1783, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/trainer.py", line 2039, in _inner_training_loop
    self.control = self.callback_handler.on_train_begin(args, self.state, self.control)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/trainer_callback.py", line 370, in on_train_begin
    return self.call_event("on_train_begin", args, state, control)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/trainer_callback.py", line 414, in call_event
    result = getattr(callback, event)(
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/integrations/integration_utils.py", line 768, in on_train_begin
    self.setup(args, state, model, **kwargs)
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/integrations/integration_utils.py", line 741, in setup
    self._wandb.init(
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/wandb/sdk/wandb_init.py", line 1200, in init
    raise e
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/wandb/sdk/wandb_init.py", line 1177, in init
    wi.setup(kwargs)
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/wandb/sdk/wandb_init.py", line 301, in setup
    wandb_login._login(
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/wandb/sdk/wandb_login.py", line 334, in _login
    wlogin.prompt_api_key()
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/wandb/sdk/wandb_login.py", line 263, in prompt_api_key
    raise UsageError("api_key not configured (no-tty). call " + directive)
wandb.errors.UsageError: api_key not configured (no-tty). call wandb.login(key=[your_api_key])
