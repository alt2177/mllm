Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: accelerate in /accounts/grad/phudish_p/.local/lib/python3.11/site-packages (0.28.0)
Requirement already satisfied: numpy>=1.17 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from accelerate) (1.23.5)
Requirement already satisfied: packaging>=20.0 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from accelerate) (21.3)
Requirement already satisfied: psutil in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from accelerate) (5.9.4)
Requirement already satisfied: pyyaml in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from accelerate) (6.0)
Requirement already satisfied: torch>=1.10.0 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from accelerate) (2.0.0)
Requirement already satisfied: huggingface-hub in /accounts/grad/phudish_p/.local/lib/python3.11/site-packages (from accelerate) (0.17.3)
Requirement already satisfied: safetensors>=0.3.1 in /accounts/grad/phudish_p/.local/lib/python3.11/site-packages (from accelerate) (0.4.2)
Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from packaging>=20.0->accelerate) (3.0.9)
Requirement already satisfied: filelock in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from torch>=1.10.0->accelerate) (3.8.2)
Requirement already satisfied: typing-extensions in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from torch>=1.10.0->accelerate) (4.4.0)
Requirement already satisfied: sympy in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from torch>=1.10.0->accelerate) (1.11.1)
Requirement already satisfied: networkx in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from torch>=1.10.0->accelerate) (2.8.8)
Requirement already satisfied: jinja2 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from torch>=1.10.0->accelerate) (3.1.2)
Requirement already satisfied: nvidia-cuda-nvrtc-cu11==11.7.99 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from torch>=1.10.0->accelerate) (11.7.99)
Requirement already satisfied: nvidia-cuda-runtime-cu11==11.7.99 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from torch>=1.10.0->accelerate) (11.7.99)
Requirement already satisfied: nvidia-cuda-cupti-cu11==11.7.101 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from torch>=1.10.0->accelerate) (11.7.101)
Requirement already satisfied: nvidia-cudnn-cu11==8.5.0.96 in /accounts/grad/phudish_p/.local/lib/python3.11/site-packages (from torch>=1.10.0->accelerate) (8.5.0.96)
Requirement already satisfied: nvidia-cublas-cu11==11.10.3.66 in /accounts/grad/phudish_p/.local/lib/python3.11/site-packages (from torch>=1.10.0->accelerate) (11.10.3.66)
Requirement already satisfied: nvidia-cufft-cu11==10.9.0.58 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from torch>=1.10.0->accelerate) (10.9.0.58)
Requirement already satisfied: nvidia-curand-cu11==10.2.10.91 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from torch>=1.10.0->accelerate) (10.2.10.91)
Requirement already satisfied: nvidia-cusolver-cu11==11.4.0.1 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from torch>=1.10.0->accelerate) (11.4.0.1)
Requirement already satisfied: nvidia-cusparse-cu11==11.7.4.91 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from torch>=1.10.0->accelerate) (11.7.4.91)
Requirement already satisfied: nvidia-nccl-cu11==2.14.3 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from torch>=1.10.0->accelerate) (2.14.3)
Requirement already satisfied: nvidia-nvtx-cu11==11.7.91 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from torch>=1.10.0->accelerate) (11.7.91)
Requirement already satisfied: triton==2.0.0 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from torch>=1.10.0->accelerate) (2.0.0)
Requirement already satisfied: setuptools in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from nvidia-cublas-cu11==11.10.3.66->torch>=1.10.0->accelerate) (65.5.1)
Requirement already satisfied: wheel in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from nvidia-cublas-cu11==11.10.3.66->torch>=1.10.0->accelerate) (0.38.4)
Requirement already satisfied: cmake in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from triton==2.0.0->torch>=1.10.0->accelerate) (3.26.1)
Requirement already satisfied: lit in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from triton==2.0.0->torch>=1.10.0->accelerate) (16.0.0)
Requirement already satisfied: fsspec in /accounts/grad/phudish_p/.local/lib/python3.11/site-packages (from huggingface-hub->accelerate) (2023.10.0)
Requirement already satisfied: requests in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from huggingface-hub->accelerate) (2.28.1)
Requirement already satisfied: tqdm>=4.42.1 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from huggingface-hub->accelerate) (4.64.1)
Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from jinja2->torch>=1.10.0->accelerate) (2.1.1)
Requirement already satisfied: charset-normalizer<3,>=2 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from requests->huggingface-hub->accelerate) (2.1.1)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from requests->huggingface-hub->accelerate) (3.4)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from requests->huggingface-hub->accelerate) (1.26.13)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from requests->huggingface-hub->accelerate) (2023.7.22)
Requirement already satisfied: mpmath>=0.19 in /usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages (from sympy->torch>=1.10.0->accelerate) (1.3.0)
2024-03-19 15:23:17.956453: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-03-19 15:23:18.631562: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-03-19 15:23:18.633280: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-19 15:23:20.398517: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/models/auto/tokenization_auto.py:655: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
Map:   0%|          | 0/989 [00:00<?, ? examples/s]Map: 100%|██████████| 989/989 [00:03<00:00, 254.41 examples/s]Map: 100%|██████████| 989/989 [00:03<00:00, 253.54 examples/s]
Map:   0%|          | 0/248 [00:00<?, ? examples/s]Map: 100%|██████████| 248/248 [00:00<00:00, 255.79 examples/s]Map: 100%|██████████| 248/248 [00:00<00:00, 254.71 examples/s]
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/accelerate/accelerator.py:432: FutureWarning: Passing the following arguments to `Accelerator` is deprecated and will be removed in version 1.0 of Accelerate: dict_keys(['dispatch_batches']). Please pass an `accelerate.DataLoaderConfiguration` instead: 
dataloader_config = DataLoaderConfiguration(dispatch_batches=None)
  warnings.warn(
error creating repo for model. it probably already exists
************TRAINING STARTED*************
  0%|          | 0/16 [00:00<?, ?it/s]You're using a T5TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/usr/local/linux/mambaforge-3.11/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  6%|▋         | 1/16 [00:20<05:03, 20.21s/it] 12%|█▎        | 2/16 [00:20<02:01,  8.65s/it] 19%|█▉        | 3/16 [00:21<01:04,  4.95s/it] 25%|██▌       | 4/16 [00:21<00:38,  3.21s/it] 31%|███▏      | 5/16 [00:22<00:24,  2.25s/it] 38%|███▊      | 6/16 [00:22<00:16,  1.67s/it] 44%|████▍     | 7/16 [00:23<00:11,  1.29s/it] 50%|█████     | 8/16 [00:23<00:08,  1.01s/it]
  0%|          | 0/2 [00:00<?, ?it/s][A
100%|██████████| 2/2 [00:00<00:00, 10.05it/s][ATraceback (most recent call last):
  File "/accounts/grad/phudish_p/mllm/summarization/Experiment_1/main.py", line 112, in <module>
    main()
  File "/accounts/grad/phudish_p/mllm/summarization/Experiment_1/main.py", line 107, in main
    trainer.train()
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/trainer.py", line 1582, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/trainer.py", line 1999, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, model, trial, epoch, ignore_keys_for_eval)
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/trainer.py", line 2328, in _maybe_log_save_evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/trainer_seq2seq.py", line 165, in evaluate
    return super().evaluate(eval_dataset, ignore_keys=ignore_keys, metric_key_prefix=metric_key_prefix)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/trainer.py", line 3066, in evaluate
    output = eval_loop(
             ^^^^^^^^^^
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/trainer.py", line 3359, in evaluation_loop
    metrics = self.compute_metrics(EvalPrediction(predictions=all_preds, label_ids=all_labels))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/grad/phudish_p/mllm/summarization/Experiment_1/main.py", line 104, in <lambda>
    compute_metrics=lambda eval_pred: compute_metrics(eval_pred, tokenizer),
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/grad/phudish_p/mllm/summarization/Experiment_1/main.py", line 31, in compute_metrics
    decoded_preds = tokenizer.batch_decode(predictions, skip_special_tokens=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3714, in batch_decode
    return [
           ^
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3715, in <listcomp>
    self.decode(
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3754, in decode
    return self._decode(
           ^^^^^^^^^^^^^
  File "/accounts/grad/phudish_p/.local/lib/python3.11/site-packages/transformers/tokenization_utils_fast.py", line 593, in _decode
    text = self._tokenizer.decode(token_ids, skip_special_tokens=skip_special_tokens)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: argument 'ids': 'list' object cannot be interpreted as an integer
 50%|█████     | 8/16 [00:26<00:26,  3.29s/it]

                                             [A